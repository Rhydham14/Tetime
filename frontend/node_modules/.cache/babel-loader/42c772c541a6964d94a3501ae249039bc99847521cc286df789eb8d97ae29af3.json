{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\n// const axiosInstance = axios.create({\n//   baseURL: \"https://tetime.onrender.com/\"\n// });\nconst axiosInstance = axios.create({\n  baseURL: \"http://localhost:8080/\"\n});\naxiosInstance.interceptors.request.use(async config => {\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  console.error(\"Request Interceptor Error:\", error);\n  return Promise.reject(error);\n});\n_s(axiosInstance.interceptors.response.use(response => {\n  if (response.data.token) {\n    const newToken = response.data.token;\n    localStorage.setItem(\"token\", newToken);\n  }\n  return response;\n}, _s(async error => {\n  _s();\n  console.error(\"Response Interceptor Error:\", error);\n  if (error.response && error.response.status === 401) {\n    const refreshToken = localStorage.getItem(\"refreshToken\");\n    if (refreshToken) {\n      try {\n        const refreshResponse = await axios.get(\"https://tetime.onrender.com/refresh/refreshtoken\", {\n          headers: {\n            \"refresh-token\": refreshToken\n          }\n        });\n        const newToken = refreshResponse.data.token;\n        localStorage.setItem(\"token\", newToken);\n\n        // Retry the original request with the new token\n        error.config.headers.Authorization = `Bearer ${newToken}`;\n        return axiosInstance(error.config);\n      } catch (refreshError) {\n        console.error(\"Error refreshing access token:\", refreshError);\n        if (refreshError.response && refreshError.response.status === 401) {\n          // Redirect to login or handle token expiration\n          const navigate = useNavigate();\n          navigate(\"/dashboard\");\n        }\n        return Promise.reject(refreshError);\n      }\n    } else {\n      console.error(\"No refresh token available\");\n    }\n  }\n  return Promise.reject(error);\n}, \"CzcTeTziyjMsSrAVmHuCCb6+Bfg=\", false, function () {\n  return [useNavigate];\n})), \"CzcTeTziyjMsSrAVmHuCCb6+Bfg=\", false, function () {\n  return [useNavigate];\n});\nexport default axiosInstance;","map":{"version":3,"names":["axios","useNavigate","axiosInstance","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","console","Promise","reject","_s","response","data","newToken","setItem","status","refreshToken","refreshResponse","get","refreshError","navigate"],"sources":["/home/rhydham/Documents/Tetime/frontend/src/Axios/axios.js"],"sourcesContent":["import axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\n// const axiosInstance = axios.create({\n//   baseURL: \"https://tetime.onrender.com/\"\n// });\nconst axiosInstance = axios.create({\n  baseURL: \"http://localhost:8080/\"\n});\naxiosInstance.interceptors.request.use(\n  async (config) => {\n    const token = localStorage.getItem(\"token\");\n\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n\n    return config;\n  },\n  (error) => {\n    console.error(\"Request Interceptor Error:\", error);\n    return Promise.reject(error);\n  }\n);\n\naxiosInstance.interceptors.response.use(\n  (response) => {\n    if (response.data.token) {\n      const newToken = response.data.token;\n      localStorage.setItem(\"token\", newToken);\n    }\n    return response;\n  },\n  async (error) => {\n    console.error(\"Response Interceptor Error:\", error);\n\n    if (error.response && error.response.status === 401) {\n      const refreshToken = localStorage.getItem(\"refreshToken\");\n\n      if (refreshToken) {\n        try {\n          const refreshResponse = await axios.get(\n            \"https://tetime.onrender.com/refresh/refreshtoken\",\n            {\n              headers: { \"refresh-token\": refreshToken }\n            }\n          );\n\n          const newToken = refreshResponse.data.token;\n          localStorage.setItem(\"token\", newToken);\n\n          // Retry the original request with the new token\n          error.config.headers.Authorization = `Bearer ${newToken}`;\n          return axiosInstance(error.config);\n        } catch (refreshError) {\n          console.error(\"Error refreshing access token:\", refreshError);\n\n          if (refreshError.response && refreshError.response.status === 401) {\n            // Redirect to login or handle token expiration\n            const navigate = useNavigate();\n            navigate(\"/dashboard\");\n          }\n\n          return Promise.reject(refreshError);\n        }\n      } else {\n        console.error(\"No refresh token available\");\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\nexport default axiosInstance;\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,QAAQ,kBAAkB;;AAE9C;AACA;AACA;AACA,MAAMC,aAAa,GAAGF,KAAK,CAACG,MAAM,CAAC;EACjCC,OAAO,EAAE;AACX,CAAC,CAAC;AACFF,aAAa,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CACpC,MAAOC,MAAM,IAAK;EAChB,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAE3C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACI,OAAO,CAACC,aAAa,GAAI,UAASJ,KAAM,EAAC;EAClD;EAEA,OAAOD,MAAM;AACf,CAAC,EACAM,KAAK,IAAK;EACTC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;EAClD,OAAOE,OAAO,CAACC,MAAM,CAACH,KAAK,CAAC;AAC9B,CACF,CAAC;AAEDI,EAAA,CAAAhB,aAAa,CAACG,YAAY,CAACc,QAAQ,CAACZ,GAAG,CACpCY,QAAQ,IAAK;EACZ,IAAIA,QAAQ,CAACC,IAAI,CAACX,KAAK,EAAE;IACvB,MAAMY,QAAQ,GAAGF,QAAQ,CAACC,IAAI,CAACX,KAAK;IACpCC,YAAY,CAACY,OAAO,CAAC,OAAO,EAAED,QAAQ,CAAC;EACzC;EACA,OAAOF,QAAQ;AACjB,CAAC,EAAAD,EAAA,CACD,MAAOJ,KAAK,IAAK;EAAAI,EAAA;EACfH,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;EAEnD,IAAIA,KAAK,CAACK,QAAQ,IAAIL,KAAK,CAACK,QAAQ,CAACI,MAAM,KAAK,GAAG,EAAE;IACnD,MAAMC,YAAY,GAAGd,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IAEzD,IAAIa,YAAY,EAAE;MAChB,IAAI;QACF,MAAMC,eAAe,GAAG,MAAMzB,KAAK,CAAC0B,GAAG,CACrC,kDAAkD,EAClD;UACEd,OAAO,EAAE;YAAE,eAAe,EAAEY;UAAa;QAC3C,CACF,CAAC;QAED,MAAMH,QAAQ,GAAGI,eAAe,CAACL,IAAI,CAACX,KAAK;QAC3CC,YAAY,CAACY,OAAO,CAAC,OAAO,EAAED,QAAQ,CAAC;;QAEvC;QACAP,KAAK,CAACN,MAAM,CAACI,OAAO,CAACC,aAAa,GAAI,UAASQ,QAAS,EAAC;QACzD,OAAOnB,aAAa,CAACY,KAAK,CAACN,MAAM,CAAC;MACpC,CAAC,CAAC,OAAOmB,YAAY,EAAE;QACrBZ,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEa,YAAY,CAAC;QAE7D,IAAIA,YAAY,CAACR,QAAQ,IAAIQ,YAAY,CAACR,QAAQ,CAACI,MAAM,KAAK,GAAG,EAAE;UACjE;UACA,MAAMK,QAAQ,GAAG3B,WAAW,CAAC,CAAC;UAC9B2B,QAAQ,CAAC,YAAY,CAAC;QACxB;QAEA,OAAOZ,OAAO,CAACC,MAAM,CAACU,YAAY,CAAC;MACrC;IACF,CAAC,MAAM;MACLZ,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAC;IAC7C;EACF;EAEA,OAAOE,OAAO,CAACC,MAAM,CAACH,KAAK,CAAC;AAC9B,CAAC;EAAA,QAZ0Bb,WAAW;AAAA,EAaxC,CAAC;EAAA,QAb4BA,WAAW;AAAA;AAexC,eAAeC,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}